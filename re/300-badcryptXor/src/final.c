#include <stdio.h>
#include <linux/memfd.h>
#include <string.h>

char key[] = "\x1f\xdd\x70\x5e\xc1\x33\x91\xfa\x95\x4e\x10\xe9\x4b\xd2\x0b\xa0\x6c\x85\xb3\x05\x93\x58\xf4\x95\xb0\xd8\x3a\xda\x74\x31\x2e\x9c\x23\x4a\xa3\x5c\x38\xa0\x5f\xb1\x03\xaa\x02\x32\x70\x0c\x71\x1a\xf7\x8f\xa2\x9c\xe1\x03\xb4\x45\xe4\x5c\x7e\x1f\x89\x17\xaf\x71\x45\xf0\xb7\x8d\xf5\xba\x7d\x16\x7d\x6c\x4b\x54\x9f\x94\x59\x83\x77\x3e\x49\xdf\x17\xea\x3b\x2d\x7e\x82\xc8\x30\x1b\x2c\x68\x6b\xfe\x47\x48\xe2\x51\xe7\x21\x5b\x47\x92\xd6\x7d\x0d\x55\x3a\x3f\xf1\x8c\xe8\x2f\x9f\x5e\xb9\x5c\x69\xfb\xcd\x07\xad\x42\x14\xac\xcc\x78\xc5\x1e\x6e\x53\x17\x68\x87\xab\x52\xcc\x2c\xdd\x82\xcc\xef\x1e\x39\xaa\x00\x73\x55\xa0\x19\x00\x01\x24\x60\x5d\xc8\x2c\x29\xee\xd9\xbb\xb3\xdd\x44\xfe\xab\xf5\xdc\xb4\xeb\xf7\xbd\x9f\x84\xb2\x1d\xd4\x63\xdb\x3a\xb9\x9b\xad\xc5\x56\x9e\x13\xe3\x0d\x85\x92\x00\x35\xf8\x9b\x24\x63\xe9\x83\xba\x76\x00\xb3\x17\xa5\xe2\xf6\x94\x73\x29\x72\xcc\x8b\x5d\xf8\x1c\x94\xf1\xc5\xb7\xff\xce\x0f\x58\xcb\x5d\xb0\x69\x4b\x62\x9e\x62\xc4\x47\x0a\xf1\x69\xa8\xe8\xb0\xed\x71\x74\x85\xf8\xe2\x6b\xb1\x86\x87\x1a\x4a\x82\xc9\x9b\x00\x55\x3f\xe5\x76\xda\x13\xa2\x15\x02\x18\x2f\x4c\x2c\x6f\x0a\x69\x1f\xeb\x5c\x98\x7e\x48\x39\x29\xf9\xa9\x34\xce\x8b\x11\xb3\x93\x9e\x94\x7c\xd6\xf2\xfc\xda\x47\xfe\x2d\xb7\x14\xbd\xb6\xf7\xad\x1c\x9b\x0d\x1d\xaf\x44\x4f\x73\x6e\x5b\x38\xef\xe7\x21\x78\xa1\xfa\x07\xbd\x96\x39\x17\xbf\x9f\x8e\x1c\x49\xe1\x31\xd6\x75\xcf\x99\x82\x5b\x3d\x81\x68\xee\x37\xbc\x79\x3c\x9b\x70\x5e\xf9\x4c\x5e\x0f\x70\xc4\x78\x8b\x1e\x43\x1b\xd3\xd7\x5a\x50\x3c\x8c\x67\x3b\x41\x52\xb3\x55\x34\xa4\x85\x7a\x15\x91\xcd\x3b\x5f\x39\xc1\x94\x5d\x1a\x65\x8b\xcc\x22\x70\xca\x4a\x8f\x72\x26\xe7\x36\x13\x9b\x74\x50\x1a\x36\x3d\x56\xe3\x65\x41\x5f\x57\xd8\x8c\xfb\xf3\x3f\x16\x18\x04\xd1\x37\x96\x5f\xd2\x08\x04\x54\xdb\xe1\xbe\x34\xb4\x8c\xcc\xf2\x61\x0d\xcf\x5a\xca\x4a\x1e\x09\xc0\xd6\xc2\x9b\x32\xb0\x97\xd2\x0e\xd2\x5f\x7b\xab\x78\xe3\xb4\x5d\x4b\x14\xf0\x09\x77\x40\x29\xee\x84\x83\x46\xc9\xba\x54\x45\x54\x9a\x74\xa1\x90\x0f\x8f\x55\x57\x81\x37\xb1\xcf\xcd\x24\x0f\xed\x05\xa0\x55\x0b\x45\xca\xc1\xc6\x02\x16\x95\xfd\x29\x10\xd0\x4c\x85\xae\x17\x1a\x55\x5f\x3c\x65\x94\x16\x84\x7e\x62\x72\x6f\x27\x43\xd5\xe7\xa8\x14\xe5\x33\xac\xff\xf6\xd0\xd9\x92\x75\x36\x93\x6a\x67\xfd\x97\x9a\x50\xe9\xf2\x8d\xa4\x4b\xd1\x37\x62\xe8\x0f\xbe\x04\x1a\x8e\x36\xe9\x68\x95\x53\x7c\x37\xe5\x34\x6f\x60\x92\x2b\x0c\x84\x09\x7a\x77\x5d\x96\x4d\xd9\x0d\xf1\xe9\xea\xe1\xee\xfc\x5f\xbf\xd4\xff\x02\x27\xf6\xec\x96\xcd\x54\x42\xfe\xa2\x96\x85\x0d\x13\x2e\x6c\x3d\x95\x3f\x7c\x20\x0c\x3c\x2f\x81\xbb\x27\x68\x08\xeb\x01\x8e\xf9\x5b\xbf\xfe\xcd\xe0\x4d\xb0\x16\x90\xc7\x03\xac\x3e\x13\xa8\x76\xef\x35\xe9\x3e\x6c\xfa\xc2\x2a\x7f\xed\xf4\x61\x43\xc1\x48\xc0\xa9\xbf\x84\x51\xba\x90\xda\x81\x68\xb5\xa7\xb8\x4f\x90\xe3\xa3\xd1\x6d\x90\x8f\xf0\x88\x6c\x19\x4f\x97\x94\x19\xf9\x54\xd6\xcd\x89\x09\xb4\x0d\xc6\xa4\xab\x95\x0b\x45\xcb\x4b\xba\x33\x1e\xc4\xa0\xdc\xbf\xf4\x57\x48\xbb\x4b\x91\xab\x56\xfa\x0b\x6b\xfa\x40\xa3\x45\x5a\xf5\x5c\x88\xc2\x41\xa4\x71\xa6\x77\x4b\x62\x67\x91\xd0\x0a\x4e\x44\xfa\xae\x36\x00\xbf\x93\xe3\x76\x0d\xcc\x8f\x5d\xb3\x8a\x37\xde\x80\xae\xb1\xab\x63\x48\x01\x56\x63\x82\x83\x0b\xd8\xea\x54\x09\x7e\x27\xf0\xd3\xa0\x13\x6f\x97\xad\x94\x2c\x4a\x3b\x37\xdd\x3b\x71\x84\x8f\x2f\x0d\x0b\x37\xd8\x13\x47\xc7\x90\xcc\xb0\xc9\xd1\xbe\x87\xa7\x53\xef\x78\x19\x56\x5f\x19\x1d\xd1\x00\x10\x66\xc4\x8d\x8d\x48\xa3\xb0\xf4\x2d\x62\xad\xdb\x54\x01\x1e\x1d\x5a\xaa\x9c\xd4\x5f\x9a\x00\xda\x16\xb0\x63\xa7\x36\x12\x98\x64\x7b\xf4\x6e\x43\x29\x48\x8c\xb3\xcf\x43\x31\x8d\x5c\xfc\xc9\xa5\xf7\x00\x70\x79\xfb\x23\xdb\xaf\x2c\x72\xa0\xac\x27\x18\x0f\x93\x0d\x99\x2d\x42\x68\x54\xd6\xbf\x96\x43\x3b\x28\x36\x37\x75\x39\x24\xdf\xb7\xb1\x19\xa8\xd0\x9c\x38\x33\xdb\x6c\x6f\xe5\x4b\x88\x06\xda\xf5\x4f\xe6\x79\xeb\x25\xf1\xad\x2c\x01\x0c\x3d\x87\x83\xcd\xb1\xd2\x27\xca\x69\x02\x41\x8c\x85\xa7\x27\x01\x71\x6f\xee\x13\x83\xe0\xe4\x22\x05\x7d\x1a\x1d\x70\x3e\xbc\x8d\x8e\x09\x8b\x64\x46\x24\x35\x0b\x5b\x02\xee\xf4\x92\x9d\x1a\x07\x03\xb4\x53\xb8\xf8\xcb\xfd\xd3\x75\xa6\x50\x16\x07\x28\xc6\xd1\x21\x12\x4f\xe7\xb4\x71\x19\xb0\x74\xef\xec\x6d\x65\x23\xdc\xc6\xc7\xe2\xf0\xd5\xcc\x73\x34\xea\x89\x28\xdd";

int main()
{
	char fname_in[255];
	char fname_out[255];
	char ch;
	int idx = 0;
	FILE *f_in;
	FILE *f_out;

	// get input filename
	printf("Enter filename you would like to encrypt: ");
	fgets(fname_in, 254, stdin);
	idx = strlen(fname_in);
	fname_in[idx-1] = 0x0;

	// get output filename
	printf("Enter filename to save encrypted file: ");
	fgets(fname_out, 254, stdin);
	idx = strlen(fname_out);
	fname_out[idx-1] = 0x0;

	// open input file
	f_in = fopen(fname_in, "r");
	if (f_in == NULL)
	{
		printf("Failed to open input file\n");
		return 1;
	}

	// get file length
	fseek(f_in, 0L, SEEK_END);
	int fsize = ftell(f_in);
	rewind(f_in);

	// open output file
	f_out = fopen(fname_out, "w");
	if (f_out == NULL)
	{
		printf("Failed to open output file\n");
		return 1;
	}

	int i = 0;
	int keyi = 0;
	while(i < fsize)
	{
		ch = fgetc(f_in);
		fputc(ch^key[keyi], f_out);
		i++;
		keyi++;
		if (keyi > 1023)
		{
			keyi = 0;
		}
	}

	return 0;
}

